---
title: '服务发现产品对比'
date: 2018-05-29 05:56:16
categories: 
- Service+JavaEE
tags: 
- micro service
- discovery
- registery
- compare
---
首先就一些常见的服务发现产品进行下对比:
<table><tbody><tr><th>对比项</th><th width="120px">[Consul](https://www.consul.io/)  [GitHub](https://github.com/hashicorp/consul)</th><th>[Zookeeper](https://zookeeper.apache.org/)  [GitHub](https://github.com/apache/zookeeper)</th><th>[Etcd](https://coreos.com/etcd/)  [GitHub](https://github.com/coreos/etcd)</th><th>Euerka  [GitHub](https://github.com/Netflix/eureka)</th><th>[Kubernetes](https://kubernetes.io/)  [GitHub](https://github.com/kubernetes/kubernetes)</th></tr><tr><td>**服务健康检查**</td><td>[客户端可绑定  任意多个服务或  节点健康检查  (内存、磁盘)](https://www.consul.io/intro/index.html)</td><td>[CS之间长连接  +连接心跳](http://zookeeper.apache.org/doc/current/zookeeperOver.html);  [SS之间TCP  KeepAlive](http://zookeeper.apache.org/doc/current/zookeeperAdmin.html)</td><td>[连接心跳](https://coreos.com/etcd/docs/latest/tuning.html)</td><td>[连接心跳注册、  其他可配支持](http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#_eureka_s_health_checks)</td><td></td></tr><tr><td>**多数据中心**</td><td>[内置WAN方案支持](https://www.consul.io/docs/internals/architecture.html)</td><td>[中央Zookeeper集群,  通过Observer有限支持](https://zookeeper.apache.org/doc/current/zookeeperObservers.html)</td><td>——</td><td>——</td><td></td></tr><tr><td>**KV存储限制**</td><td>上百MB</td><td>上百MB  （有时支持上GB）</td><td>上GB</td><td>——</td><td></td></tr><tr><td>**线性化读取  原子读取**</td><td>[是](https://www.consul.io/docs/agent/http.html#consistency)</td><td>否</td><td>[是](https://coreos.com/etcd/docs/latest/learning/api_guarantees.html#linearizability)</td><td>——</td><td></td></tr><tr><td>**事务**</td><td>[字段比较、  锁、读、写](https://www.consul.io/api/txn.html)</td><td>[版本审查、  写](https://zookeeper.apache.org/doc/current/api/org/apache/zookeeper/ZooKeeper.html#multi-java.lang.Iterable-)</td><td>[字段比较、  读、写](https://coreos.com/etcd/docs/latest/learning/api.html#transaction)</td><td>——</td><td></td></tr><tr><td>**多版本并发控制  MVCC**</td><td>——</td><td>——</td><td>[支持](https://coreos.com/etcd/docs/latest/learning/data_model.html)</td><td>——</td><td></td></tr><tr><td>**watch支持/  变化通知**</td><td>[针对KV对、键前缀、  服务成员、服务实例、  节点列表、健康检查、  自定义用户事件等](https://www.consul.io/docs/agent/watches.html)</td><td>[针对当前KV或目录;  单次](http://zookeeper.apache.org/doc/current/zookeeperProgrammers.html#ch_zkWatches)</td><td>[针对过去或当前的键区间](https://coreos.com/etcd/docs/latest/learning/api.html#watch-streams)</td><td>[针对app、  vipAddress  或实例](https://github.com/Netflix/eureka/wiki/Eureka-2.0-Client-Configuration-And-Use#using-the-interest-client)</td><td></td></tr><tr><td>**一致性协议**</td><td>[Raft](https://www.consul.io/docs/internals/consensus.html)</td><td>[Zab（≈Paxos）](https://cwiki.apache.org/confluence/display/ZOOKEEPER/Zab+vs.+Paxos)</td><td>[Raft](https://github.com/coreos/etcd)</td><td>——</td><td></td></tr><tr><td>**CAP**</td><td>[CP](https://www.consul.io/intro/vs/serf.html)</td><td>[CP](https://www.elastic.co/blog/found-zookeeper-king-of-coordination)</td><td>CP</td><td>[AP](https://github.com/Netflix/eureka/wiki/Eureka-2.0-Architecture-Overview#cap-theorem)</td><td></td></tr><tr><td>**成员动态更新**</td><td>[支持](https://www.consul.io/docs/guides/servers.html)</td><td>[>3.5.0](https://cwiki.apache.org/confluence/display/ZOOKEEPER/ClusterMembership)</td><td>[支持](https://coreos.com/etcd/docs/latest/op-guide/runtime-configuration.html)</td><td>[支持](https://github.com/Netflix/eureka/wiki/Eureka-at-a-glance#configurability)</td><td></td></tr><tr><td>**支持接口**</td><td>[HTTP](https://www.consul.io/api/index.html)和[DNS](https://www.consul.io/docs/agent/dns.html)</td><td>[客户端](https://cwiki.apache.org/confluence/display/ZOOKEEPER/ZKClientBindings)</td><td>[HTTP](https://coreos.com/etcd/docs/latest/dev-guide/api_grpc_gateway.html)和gRPC</td><td>[HTTP](https://github.com/Netflix/eureka/wiki/Eureka-REST-operations) ([Sidecar](https://cloud.spring.io/spring-cloud-netflix/multi/multi__polyglot_support_with_sidecar.html))</td><td></td></tr><tr><td>**性能指标监控**</td><td>[Metrics](https://www.consul.io/docs/agent/telemetry.html)</td><td>——  (可通过[命令行](http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_zkCommands)  或[JMX](http://zookeeper.apache.org/doc/current/zookeeperJMX.html)监控，  但没有Metrics)</td><td>[Metrics](https://coreos.com/etcd/docs/latest/metrics.html)</td><td>[Metrics](https://github.com/Netflix/eureka/blob/master/eureka-core/src/main/java/com/netflix/eureka/util/EurekaMonitors.java)</td><td></td></tr><tr><td>**用户权限**</td><td>[ACLs](https://www.consul.io/docs/guides/acl.html)</td><td>[ACLs](https://zookeeper.apache.org/doc/current/zookeeperProgrammers.html#sc_ZooKeeperAccessControl)</td><td>[基于Role](https://coreos.com/etcd/docs/latest/op-guide/authentication.html)</td><td>——</td><td></td></tr><tr><td>**安全**</td><td>[TLS](https://www.consul.io/docs/agent/encryption.html) / [HTTPS](https://www.consul.io/docs/agent/encryption.html)</td><td>[SSL](https://cwiki.apache.org/confluence/display/ZOOKEEPER/ZooKeeper+SSL+User+Guide)</td><td>[TLS](https://coreos.com/etcd/docs/latest/op-guide/security.html) / [HTTPS](https://coreos.com/etcd/docs/latest/etcd-live-http-to-https-migration.html)</td><td>[HTTPS](http://cloud.spring.io/spring-cloud-static/spring-cloud-netflix/2.0.0.RC2/single/spring-cloud-netflix.html#_registering_a_secure_application)</td><td></td></tr><tr><td>**Web管理界面**</td><td>[支持](https://www.consul.io/intro/getting-started/ui.html)</td><td>支持</td><td>——  （有第三方支持，  例如soyking/e3w）</td><td>[支持](https://github.com/Netflix/eureka-ui)</td><td></td></tr><tr><td>**Spring Cloud集成**</td><td>[Spring Cloud Consul](https://cloud.spring.io/spring-cloud-consul/)</td><td>[Spring Cloud Zookeeper](https://cloud.spring.io/spring-cloud-zookeeper/)</td><td>[Spring Cloud Etcd](https://github.com/spring-cloud-incubator/spring-cloud-etcd)  （孵化状态）</td><td>[Spring Cloud Netflix](https://cloud.spring.io/spring-cloud-netflix/)</td><td>[Spring Cloud Kubernetes](https://github.com/spring-cloud-incubator/spring-cloud-kubernetes)  （孵化状态）</td></tr><tr><td>**实现语言**</td><td>[Go](https://github.com/hashicorp/consul)</td><td>[Java](https://github.com/apache/zookeeper)</td><td>[Go](https://github.com/coreos/etcd)</td><td>[Java](https://github.com/Netflix/eureka)</td><td>[Go](https://github.com/kubernetes/kubernetes)</td></tr><tr><td>**用户**</td><td>未提及</td><td>[用户列表](https://cwiki.apache.org/confluence/display/ZOOKEEPER/PoweredBy)</td><td>[用户列表](https://github.com/coreos/etcd/blob/master/Documentation/production-users.md)</td><td>除了Netflix自用  未提及其他用户</td><td>[合作方列表](https://kubernetes.io/partners/)</td></tr></tbody></table>

此外，Airbnb开源了由[Ruby](https://github.com/airbnb/smartstack-cookbook)语言实现的自动服务发现和注册框架[SmartStack](https://github.com/airbnb/smartstack-cookbook)，它由[nerve](https://github.com/airbnb/nerve)、 [synapse](https://github.com/airbnb/synapse)、Zookeeper和HAProxy组成。ZooKeeper负责维护集群状态；[nerve](https://github.com/airbnb/nerve)负责针对服务进行健康检查及向Zookeeper注册；[synapse](https://github.com/airbnb/synapse)负责为服务提供者查询Zookeeper并动态配置HAProxy。客户端与HAProxy交互，HAProxy负责健康检查及在针对服务提供者进行负载均衡。
注：对Kubernetes的对比在后继学习之后再补上。

### 参考
******
[Consul vs. ZooKeeper, doozerd, etcd](https://www.consul.io/intro/vs/zookeeper.html)  
[Consul vs. SmartStack](https://www.consul.io/intro/vs/smartstack.html)  
[Consul vs. Eureka](https://www.consul.io/intro/vs/eureka.html)  
[etcd versus other key-value stores](https://coreos.com/etcd/docs/latest/learning/why.html)  
[服务发现比较:Consul vs Zookeeper vs Etcd vs Eureka](https://luyiisme.github.io/2017/04/22/spring-cloud-service-discovery-products/)  
[SmartStack: Airbnb的自动服务发现和注册框架](https://www.jianshu.com/p/771240b3668d)  
[课程：使用Kubernetes进行可扩展微服务](https://cn.udacity.com/course/scalable-microservices-with-kubernetes--ud615)  
[Consul实践指导-DNS接口](https://blog.csdn.net/younger_china/article/details/52264525)  
[Please stop calling databases CP or AP](https://martin.kleppmann.com/2015/05/11/please-stop-calling-databases-cp-or-ap.html)  

